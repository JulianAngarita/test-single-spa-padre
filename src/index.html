<!DOCTYPE html>
<html>
<head>
    <title>Single-spa Padre</title>
    <base href="/">
    <!-- Preload de SystemJS -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/systemjs@6.10.0/dist/system.min.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/single-spa@5.9.0/lib/umd/single-spa.min.js" as="script">
</head>
<body>
    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/zone.js@0.14.5/bundles/zone.umd.min.js"></script>
    <!-- Cargar SystemJS primero -->
    <script src="https://cdn.jsdelivr.net/npm/systemjs@6.10.0/dist/system.min.js"></script>
    <!-- Luego single-spa UMD -->
    <script src="https://cdn.jsdelivr.net/npm/single-spa@5.9.0/lib/umd/single-spa.min.js"></script>
    
    <script>
        // Esperar a que todo est√© cargado
        window.addEventListener('load', function() {
            console.log('=== VERIFICACI√ìN INICIAL ===');
            console.log('System disponible:', typeof System !== 'undefined');
            console.log('singleSpa disponible:', typeof singleSpa !== 'undefined');
            
            if (typeof singleSpa === 'undefined') {
                console.error('‚ùå singleSpa no se carg√≥ correctamente');
                return;
            }
            
            if (typeof System === 'undefined') {
                console.error('‚ùå SystemJS no se carg√≥ correctamente');
                return;
            }
            
            console.log('‚úÖ Todas las dependencias cargadas');
            
            // Registrar aplicaci√≥n
            singleSpa.registerApplication({
                name: "test-single-spa-hijo",
                app: () => {
                    console.log('üì¶ Cargando microfrontend hijo...');
                    return System.import("http://localhost:4000/main.single-spa.js")
                        .catch(err => {
                            console.error('‚ùå Error cargando microfrontend:', err);
                            throw err;
                        });
                },
                activeWhen: ["/"]
            });
            
            // Iniciar single-spa
            singleSpa.start();
            console.log('üöÄ single-spa iniciado correctamente');
            
            // Verificar que la aplicaci√≥n se registr√≥
            console.log('Aplicaciones registradas:', singleSpa.getAppNames());
        });
    </script>
</body>
</html>